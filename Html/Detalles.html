<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name = "description" content = "USC Predict es una plataforma de predicción de eventos">
    <meta name = "keywords" content = "USC, Predict, Eventos, Predicción">
    <meta name = "author" content = "Mateo Bodenlle y Diego Cristóbal">
    <title>Menú y Footer</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../Css/styles.css">
    <link rel="stylesheet" href="../Css/index.css">
    <link rel="stylesheet" href="../Css/layoutComun.css">
    <link rel="stylesheet" href="../Css/Detalles.css">
</head>
<body>

<!-- Encabezado principal del sitio -->
<header id="navbar"></header>

<!-- Contenido principal -->
<main class="page-container">
    <section class="main-content">
        <div class="evento-header">
            <img class="Imagen" src="../Resources/ImagenEventos/Examen.jpg" alt="Examen de álgebra">
            <article class="exam-details">
                <div class="date">
                    <div class="property">Resolution: </div><div class="value">12/02/2025</div>
                </div>
                <div class="views">
                    <div class="property">Views: </div><div class="value">15.2k</div>
                </div>
            </article>
        </div>

        <p class="exam-description">
            Este evento resolverá si la nota del examen de álgebra de 1o de GEI alcanza una nota media
            estrictamente mayor que 6. Se considera media sin tener en cuenta a los "no presentado",
            y tras el período de reclamación.
        </p>

        <!-- Contenedor de la gráfica -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">49% chance</h3>
                <span class="chart-subtitle">v-0.5</span>
            </div>

            <!-- Canvas para Chart.js -->
            <canvas id="myChart" width="400" height="200"></canvas>
        </div>

        <!-- Importa Chart.js desde un CDN (versión 4.x en el ejemplo) -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <script>
            // Datos estáticos de ejemplo (fechas y valores)
            const labels = [
                'Mar 1', 'Mar 2', 'Mar 3', 'Mar 4', 'Mar 5', 'Mar 6', 'Mar 7',
                'Mar 8', 'Mar 9', 'Mar 10', 'Mar 11', 'Mar 12', 'Mar 13',
                'Mar 14', 'Mar 15', 'Mar 16', 'Mar 17', 'Mar 18', 'Mar 19',
                'Mar 20', 'Mar 21', 'Mar 22',
                'Mar 23', 'Mar 24', 'Mar 25', 'Mar 26', 'Mar 27', 'Mar 28', 'Mar 29', 'Mar 30'
            ];
            const dataPoints = [0.13, 0.2,0.52,0.8,0.6,0.4,0.45,0.2,0.1,0.5,0.7,0.9,0.8,
                0.6,0.4,0.3,0.2,0.1,0.5,0.7,0.6,
                0.8,0.6,0.4,0.3,0.2,0.2,0.5,0.6,0.49,
            ]; // Datos de ejemplo (valores entre 0 y 1)];
            // Los valores se interpretan como 0.13 = 13%, etc.

            // Configuración del gráfico
            const data = {
                labels: labels,
                datasets: [{
                    label: 'Chance over time',
                    data: dataPoints,
                    borderColor: '#56b6c2',    // color de línea (Polymarket-like)
                    backgroundColor: '#56b6c2',// color de punto
                    fill: false,
                    tension: 0.3,             // curva suave
                    pointRadius: 3,
                    pointHoverRadius: 6
                }]
            };

            const config = {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            // Conviértelo a porcentaje (0-1 → 0%-100%)
                            ticks: {
                                callback: function(value) {
                                    return (value * 100) + '%';
                                }
                            },
                            min: 0,
                            max: 1
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // Oculta la leyenda de la línea
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    // Muestra el valor en porcentaje
                                    let val = context.parsed.y * 100;
                                    return val.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            };

            // Inicializa la gráfica
            const ctx = document.getElementById('myChart').getContext('2d');
            new Chart(ctx, config);
        </script>


        <p class="event-note">
            Este evento se realiza por la gran incertidumbre de
            las próximas del examen. Nunca se rinden y es
            una lotería. Se puede estudiar todo el temario y
            caer solo una pregunta concreta.
        </p>
    </section>


    <aside class="voting-sidebar">
        <h1 class="Titulo_Evento">Examen de álgebra nota media mayor que 6</h1>

        <section class="contenedor-apuesta">
            <article class="header-Apuesta">
            <h2>Votar</h2>
            <button class="market-limit" id="marketLimitBtn">Market</button>
            </article>
            <article class="vote-input">
                <label for="vote-count">Número de votos</label>
                <input type="text" id="vote-count" name="vote-count">
                <div class="botones-aumento">
                    <div class="botones-aumento-lado">
                        <button class="disminucion" id="boton-100">-100</button>
                        <button class="disminucion" id="boton-10">-10</button>
                    </div>
                    <div class="botones-aumento-lado">
                        <button class="aumento" id="boton+10">+10</button>
                        <button class="aumento" id="boton+100">+100</button>
                    </div>
                </div>
            </article>
            <article class="precio">
                <label for="precio-input">Precio</label>
                <div class="selectorPrecio">
                    <button class="disminuir-precio" >-</button>
                    <input class="precio-input" name="precio-input" id="precio-input" type="number" value="0.50">
                    <button class="aumentar-precio" >+</button>
                </div>
            </article>
            <article class="botones-votar">
                <button class="boton-si">Si</button>
                <button class="boton-no">No</button>
            </article>
            <article class="reporte">
                <div class="reporte-fila">
                    <div class ="info-propiedad">TOTAL: </div>
                    <div class ="info-valor">0 voting points</div>
                </div>
                <div class="reporte-fila">
                    <div class ="info-propiedad">POSIBLE WIN: </div>
                    <div class ="info-valor" id="WIN">0 voting points</div>
                </div>
            </article>
            <button class="vote-button">VOTAR</button>
        </section>
    </aside>
</main>



<!-- Pie de página -->
<footer id="footer"></footer>


</body>

</html>
<script src="../Js/componentes.js"></script>
<script>
    // Seleccionamos los elementos
    let precio = 0.49;

    const precioMercado = precio.toFixed(2);
    const marketLimitBtn = document.querySelector("#marketLimitBtn");
    const precioSection = document.querySelector(".precio");
    const contenedorApuesta = document.querySelector(".contenedor-apuesta");


    // Variable para controlar si está en modo Market o Limit
    // true = Market, false = Limit
    let isMarketMode = true;

    // Ocultar el precio por defecto si empiezas en Market:
    precioSection.style.display = "none"; // <-- Opcional, si quieres empezar oculto


    function actualizarDatosApuesta() {
        let total = parseInt(inputVoto.value) * parseFloat(inputPrecio.value);
        document.querySelector(".info-valor").textContent = total.toFixed(2) + " voting points";
        let win = (parseInt(inputVoto.value));
        document.querySelector("#WIN").textContent = win.toFixed(2) + " voting points";
    }


    // Escuchamos el clic en el botón
    marketLimitBtn.addEventListener("click", () => {
        // Cambiamos el modo
        isMarketMode = !isMarketMode;
        console.log(isMarketMode);
        if (isMarketMode) {
            // Si es Market: mostramos texto "Market" y ocultamos la sección de precio
            marketLimitBtn.textContent = "Market";
            precio = precioMercado;
            precioSection.querySelector("input").value = precio;
            actualizarDatosApuesta();
            precioSection.style.display = "none";
            contenedorApuesta.style.height = "436px"; // Ajusta la altura del contenedor

        } else {
            // Si es Limit: mostramos texto "Limit" y volvemos a mostrar la sección de precio
            contenedorApuesta.style.height = "540px"; // Ajusta la altura del contenedor
            setTimeout(() => {
                precioSection.style.display = "block";
            }, 60);
            marketLimitBtn.textContent = "Limit";
        }
    });

    // Cuando voton-si o voton-no son pulsados, se "activan"
    let modo = "start"; //no, si o start
    let botonSi = document.querySelector(".boton-si");
    let botonNo = document.querySelector(".boton-no");
    let botonVotar = document.querySelector(".vote-button");
    let precioInput = document.querySelector(".precio-input");

    // Cambiar el valor por defecto de input-precio a la variable precio
    precioInput.value = precio;

    // Desactivar el botón de votar por defecto
    botonVotar.disabled = true;

    botonSi.addEventListener("click", function() {
        modo = "si";
        botonSi.classList.add("active");
        botonNo.classList.remove("active");
        precioInput.value = precio;
        // Activar el botón de votar
        botonVotar.disabled = false;

        // añadimos la clase .si al botón de votar
        botonVotar.classList.add("si");

        //Quitamos la clase no
        botonVotar.classList.remove("no");
    });

    botonNo.addEventListener("click", function() {
        modo = "no";
        botonNo.classList.add("active");
        botonSi.classList.remove("active");
        precioInput.value = 1 - precio;
        // Activar el botón de votar
        botonVotar.disabled = false;
        // añadimos la clase .no al botón de votar
        botonVotar.classList.add("no");
        //Quitamos la clase si
        botonVotar.classList.remove("si");
    });

    botonVotar.addEventListener("click", function() {
        if (modo === "si") {
            alert("Has votado 'Sí' con un precio de " + precioInput.value);
        } else if (modo === "no") {
            alert("Has votado 'No' con un precio de " + precioInput.value);
        } else {
            alert("Por favor, selecciona una opción antes de votar.");
        }
    });
<!--Script para botones de más votos o más precio-->
    // Seleccionamos los botones y el input
    const botonMas10 = document.querySelector("#boton\\+10");
    const botonMas100 = document.querySelector("#boton\\+100");
    const botonMenos10 = document.querySelector("#boton-10");
    const botonMenos100 = document.querySelector("#boton-100");

    const botonAumentarPrecio = document.querySelector(".aumentar-precio");
    const botonDisminuirPrecio = document.querySelector(".disminuir-precio");

    const inputVoto = document.querySelector("#vote-count");
    const inputPrecio = document.querySelector("#precio-input");
    // Añadimos los event listeners
    botonMas10.addEventListener("click", function() {
        if (inputVoto.value === "") {
            inputVoto.value = 0;
        }
        inputVoto.value = parseInt(inputVoto.value) + 10;
    });
    botonMas100.addEventListener("click", function() {
        if (inputVoto.value === "") {
            inputVoto.value = 0;
        }
        inputVoto.value = parseInt(inputVoto.value) + 100;
    });
    botonMenos10.addEventListener("click", function() {
        if (inputVoto.value === "") {
            inputVoto.value = 0;
        }
        inputVoto.value = parseInt(inputVoto.value) - 10;
        if (inputVoto.value < 0) {
            inputVoto.value = 0;
        }
    });
    botonMenos100.addEventListener("click", function() {
        if (inputVoto.value === "") {
            inputVoto.value = 0;
        }
        inputVoto.value = parseInt(inputVoto.value) - 100;
        if (inputVoto.value < 0) {
            inputVoto.value = 0;
        }
    });

    botonAumentarPrecio.addEventListener("click", function() {
        inputPrecio.value = (parseFloat(inputPrecio.value) + 0.01).toFixed(2);
    });
    botonDisminuirPrecio.addEventListener("click", function() {
        inputPrecio.value = (parseFloat(inputPrecio.value) - 0.01).toFixed(2);
    });



    // Ante cualquier cambio en los inputs (cambio en el input de votos/precio manual o con los botones)
    // se actualiza el valor de WIN y de TOTAL



    inputPrecio.addEventListener("input",actualizarDatosApuesta);
    inputVoto.addEventListener("input",actualizarDatosApuesta);
    //Con los botones
    botonMas10.addEventListener("click",actualizarDatosApuesta);
    botonMas100.addEventListener("click",actualizarDatosApuesta);
    botonMenos10.addEventListener("click",actualizarDatosApuesta);
    botonMenos100.addEventListener("click",actualizarDatosApuesta);

    // Con los botones de selector precio
    botonAumentarPrecio.addEventListener("click",actualizarDatosApuesta);
    botonDisminuirPrecio.addEventListener("click",actualizarDatosApuesta);



    // Si total o WIN valen NaN, se cambian a 0
    inputVoto.addEventListener("change", function() {
        if (isNaN(parseInt(inputVoto.value))) {
            document.querySelector(".info-valor").textContent = "0 voting points";
            document.querySelector("#WIN").textContent = "0 voting points";
        }
    });
    inputPrecio.addEventListener("change", function() {
        if (isNaN(parseFloat(inputPrecio.value))) {
            document.querySelector(".info-valor").textContent = "0 voting points";
            document.querySelector("#WIN").textContent = "0 voting points";
        }
    });



</script>

<script src="../Js/trendingListsIndex.js"> </script>

